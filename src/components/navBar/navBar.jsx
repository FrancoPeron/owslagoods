import React, {useState, useEffect } from 'react'
import '../../style/components/navBar.css'

// Router
import {Link, NavLink }  from 'react-router-dom'

// Data Base
import {db} from '../../firebase/firebase.config'
import {getDocs, collection, query, orderBy, where} from 'firebase/firestore'

// Components
import CartWidget from './cartWitget.jsx'

const NavBar = ()=>{

    const categoryCollection = getDocs(query(collection(db,'category'), orderBy("position", "asc")))
    const [category, setCategory] = useState([])
    const [showCategory, setShowCategory] = useState(false)

    useEffect(()=>{


        categoryCollection.then(result => {
            setCategory(result.docs.map(doc => {
                return{
                    id: doc.id,
                    ...doc.data(),
                }
            }))
            setShowCategory(true)
        })
        .catch(error => console.log(error))

        
    },[])
    
    return(
        <header className="header">

            <div className="header__logo">
                <p className="header__logo-text">OWSLA</p>
                <Link to="/">
                    <svg className="header__logo-img" height="213" viewBox="0 0 166 213" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M70.93 0.566101C39.2361 5.71613 14.3303 26.7454 4.29146 56.8826C1.42322 65.5137 0.419344 70.9499 0.0847168 79.9624C-0.24991 89.4995 0.37154 95.5078 2.57052 104.044C5.24753 114.344 9.02404 122.593 15.0473 131.32L18.1068 135.754V173.664C18.1068 173.664 18.0847 206.566 18.0847 209.066C18.0847 211.566 18.0847 212.566 19.5 212.909C20.5847 213.066 22 212.001 25.1339 204.898C28.2679 197.796 45.9286 158.882 46.1198 158.691C46.2154 158.596 48.5578 159.406 51.3783 160.503C63.8073 165.462 69.3047 166.512 83.12 166.512C92.4896 166.464 94.4973 166.321 98.8475 165.415C105.062 164.032 111.85 161.886 116.439 159.788L119.929 158.214L121.363 161.409C141.345 205.852 144.596 212.766 145.743 212.909C148.181 213.291 148.133 214.245 148.133 173.521V135.659L151.527 130.652C158.841 119.684 163.335 108.383 165.39 95.4601C166.203 90.5485 166.203 76.0522 165.39 71.1406C161.614 47.3455 148.324 26.507 128.534 13.3458C120.503 8.00504 109.364 3.42723 99.1343 1.28139C92.6808 -0.0538058 77.1923 -0.435294 70.93 0.566101ZM97.3656 10.7708C111.898 13.8704 125.57 21.2616 135.561 31.4186L138.094 33.9936L117.204 80.3439L96.2661 126.694H83.0722H69.9262L69.1135 125.025C68.6833 124.071 59.2659 103.233 48.1754 78.7226L28.05 34.089L31.0616 30.9894C37.6585 24.3135 48.5578 17.3037 57.545 14.0134C62.1819 12.2967 67.3926 10.9138 72.412 10.1032C78.3396 9.14949 91.3423 9.48329 97.3656 10.7708ZM18.0112 100.086L17.8678 117.395L16.577 114.963C14.7605 111.482 12.0357 103.519 10.8406 97.8921C9.98012 93.8388 9.7889 91.55 9.7889 83.5388C9.7411 70.8545 11.0796 64.1785 15.86 53.2585L17.8678 48.7284L18.0112 65.7521C18.059 75.0985 18.059 90.5485 18.0112 100.086ZM152.866 59.8391C158.794 77.5781 157.694 97.5106 149.806 114.439L148.181 117.872V83.3004L148.229 48.7284L149.806 52.1618C150.715 54.0692 152.101 57.5026 152.866 59.8391ZM43.4428 91.4069C51.9041 110.147 58.9313 125.788 59.0747 126.074C59.2659 126.551 55.9674 126.694 43.4906 126.694H27.6675V91.7883C27.6675 72.6188 27.7632 57.0257 27.8588 57.1211C27.9544 57.2164 34.9815 72.6665 43.4428 91.4069ZM138.572 92.1221V126.694H122.797C114.145 126.694 107.022 126.599 107.022 126.456C107.022 126.217 136.947 59.7915 137.664 58.3609C137.951 57.9317 138.238 57.5502 138.333 57.5502C138.477 57.5502 138.572 73.0956 138.572 92.1221ZM68.2052 146.388C70.691 151.872 72.651 156.402 72.5554 156.45C72.1729 156.784 63.8073 154.829 59.7439 153.446C51.2826 150.632 40.6702 144.481 34.5991 138.902L31.7309 136.279L47.7452 136.374L63.7595 136.47L68.2052 146.388ZM91.7247 136.47C91.7247 136.708 83.6937 154.781 83.2634 155.496C83.0244 155.878 74.5153 137.614 74.5153 136.66C74.5153 136.422 78.005 136.231 83.12 136.231C87.8526 136.231 91.7247 136.327 91.7247 136.47ZM132.358 138.186C124.423 145.291 116.105 150.108 106.114 153.398C100.664 155.21 94.3539 156.641 93.8759 156.164C93.7325 156.068 95.6446 151.491 98.0826 146.102L102.481 136.231H118.495L134.509 136.279L132.358 138.186ZM37.3239 153.35C37.6107 153.636 28.5758 174.57 27.8588 175.286C27.7632 175.381 27.6675 168.8 27.6675 160.646V145.768L32.3523 149.392C34.8859 151.395 37.1327 153.16 37.3239 153.35ZM138.572 160.551C138.572 168.419 138.429 174.856 138.238 174.856C137.855 174.856 128.534 154.352 128.534 153.589C128.534 153.303 129.107 152.778 129.872 152.349C130.589 151.92 132.693 150.394 134.509 148.916C136.374 147.437 137.999 146.245 138.238 146.245C138.429 146.245 138.572 152.683 138.572 160.551Z" fill="white"/>
                    </svg>
                </Link>
                <p className="header__logo-text">GOODS</p>
            </div>

            <div className="header__nav">
                <input type="checkbox" name="burger-btn" id="burger" />
                <label htmlFor="burger" className="burger-btn">
                    <div className="burger"></div>
                </label>
                
                <svg width="24" height="24" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M20.638 18.8702L19.7541 17.9864L17.9864 19.7541L18.8702 20.638L20.638 18.8702ZM25.3661 27.1339C25.8543 27.622 26.6457 27.622 27.1339 27.1339C27.622 26.6457 27.622 25.8543 27.1339 25.3661L25.3661 27.1339ZM21.25 13.125C21.25 17.6123 17.6123 21.25 13.125 21.25V23.75C18.993 23.75 23.75 18.993 23.75 13.125H21.25ZM13.125 21.25C8.63769 21.25 5 17.6123 5 13.125H2.5C2.5 18.993 7.25697 23.75 13.125 23.75V21.25ZM5 13.125C5 8.63769 8.63769 5 13.125 5V2.5C7.25697 2.5 2.5 7.25697 2.5 13.125H5ZM13.125 5C17.6123 5 21.25 8.63769 21.25 13.125H23.75C23.75 7.25697 18.993 2.5 13.125 2.5V5ZM18.8702 20.638L25.3661 27.1339L27.1339 25.3661L20.638 18.8702L18.8702 20.638Z" fill="black"/>
                </svg>

                <nav className="nav">
                    <ul className="nav__list">
                        {
                            showCategory
                            ?   <>
                                    <li className="nav__item">
                                        <NavLink to="/all" className="nav__link--black" href="">all</NavLink>
                                    </li>
                                    {
                                        category.map( (item) =>
                                            <li key={item.id} className="nav__item">
                                                <NavLink to={`/products/${item.name}`} className="nav__link--black" href="">{item.name}</NavLink>
                                            </li>
                                        )
                                    }
                                </>
                            :   null
                        }
                    </ul>
                </nav>

                <Link to="/cart"><CartWidget /></Link>
            </div>

        </header>
    )
}

export default NavBar